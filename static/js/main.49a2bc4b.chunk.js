(this.webpackJsonptoolbox=this.webpackJsonptoolbox||[]).push([[0],{11:function(e,t,n){"use strict";(function(e){n.d(t,"c",(function(){return O})),n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return x}));var r=n(4),a=n(6),c=n(2),s=n.n(c),u=n(0),o=n(15),i=n(23),l=n(22),d=n(1),b=Object(u.createContext)(),j=l.token_key;function p(t){if(!t)return{};var n=t.split(".")[1],r=e.from(n,"base64").toString("ascii");return JSON.parse(r)}function f(e){return e?("number"!==typeof e&&(e=Number(e)),isNaN(e)?null:new Date(1e3*e)):null}var h=function(){return Object(u.useContext)(b)},O=function(){var e=h(),t=e.loading,n=e.error,r=e.token,a=e.lid,c=e.ready,s=e.hasRole;return{loading:t,error:n,token:r,lid:a,ready:c,isAuthed:Boolean(r),hasRole:s}},m=function(){return h().login},x=function(e){var t=e.children,n=Object(u.useState)(!1),c=Object(a.a)(n,2),l=c[0],h=c[1],O=Object(u.useState)(!1),m=Object(a.a)(O,2),x=m[0],v=m[1],g=Object(u.useState)(""),w=Object(a.a)(g,2),k=w[0],y=w[1],N=Object(u.useState)(localStorage.getItem(j)),S=Object(a.a)(N,2),C=S[0],B=S[1],D=Object(u.useState)(null),I=Object(a.a)(D,2),L=I[0],A=I[1],F=Object(u.useCallback)(function(){var e=Object(r.a)(s.a.mark((function e(t,n){var r,a,c,u,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=p(t),a=r.exp,c=r.userId,u=f(a),(l=u>=new Date)?localStorage.setItem(j,t):(localStorage.removeItem(j),t=null,u&&y("Session expired, sign in again")),o.b(t),h(t&&l),B(t),n||!l){e.next=11;break}return e.next=10,i.a(c);case 10:n=e.sent;case 11:A(n);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[]);Object(u.useEffect)((function(){F(C)}),[C,F]);var J=Object(u.useCallback)(function(){var e=Object(r.a)(s.a.mark((function e(t){var n,r,a,c,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.mail,r=t.wachtwoord,e.prev=1,v(!0),y(""),e.next=6,i.b(n,r);case 6:return a=e.sent,c=a.token,u=a.user,e.next=11,F(c,u);case 11:return e.abrupt("return",!0);case 14:return e.prev=14,e.t0=e.catch(1),console.error(e.t0),y("Login failed"),e.abrupt("return",!1);case 19:return e.prev=19,v(!1),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[1,14,19,22]])})));return function(t){return e.apply(this,arguments)}}(),[F]),E=Object(u.useCallback)(function(){var e=Object(r.a)(s.a.mark((function e(t){var n,r,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,v(!0),y(""),e.next=5,i.c(t);case 5:return n=e.sent,r=n.token,a=n.lid,e.next=10,F(r,a);case 10:return e.abrupt("return",!0);case 13:return e.prev=13,e.t0=e.catch(0),y(e.t0),e.abrupt("return",!1);case 17:return e.prev=17,v(!1),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[0,13,17,20]])})));return function(t){return e.apply(this,arguments)}}(),[F]),R=Object(u.useCallback)((function(){F(null),A(null)}),[F]),M=Object(u.useCallback)((function(e){return!!L&&L.roles.include(L)}),[L]),P=Object(u.useMemo)((function(){return{loading:x,error:k,token:C,lid:L,login:J,logout:R,register:E,ready:l,hasRole:M}}),[x,k,C,L,J,R,E,l,M]);return Object(d.jsx)(b.Provider,{value:P,children:t})}}).call(this,n(49).Buffer)},15:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return u}));var r=n(38),a=n.n(r),c=n(22),s=a.a.create({baseURL:c.url}),u=function(e){e?s.defaults.headers.Authorization="Bearer ".concat(e):delete s.defaults.headers.Authorization}},22:function(e){e.exports=JSON.parse('{"url":"https://dendermondse-bc.herokuapp.com/api/","token_key":"auth_token"}')},23:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return i}));var r=n(4),a=n(2),c=n.n(a),s=n(15),u=function(){var e=Object(r.a)(c.a.mark((function e(t,n){var r,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.post("account/login",{mail:t,wachtwoord:n});case 2:return r=e.sent,a=r.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),o=function(){var e=Object(r.a)(c.a.mark((function e(t,n,r,a,u,o,i,l,d,b,j){var p,f;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.post("account",{mail:t,wachtwoord:n,voornaam:r,achternaam:a,adres:u,postcode:o,woonplaats:i,geslacht:l,geboortedatum:d,gsm:b,spelertype:j});case 2:return p=e.sent,f=p.data,e.abrupt("return",f);case 5:case"end":return e.stop()}}),e)})));return function(t,n,r,a,c,s,u,o,i,l,d){return e.apply(this,arguments)}}(),i=function(){var e=Object(r.a)(c.a.mark((function e(t){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.get("account/".concat(t));case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},47:function(e,t,n){},48:function(e,t,n){},77:function(e,t,n){},78:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(37),s=n.n(c),u=(n(47),n(48),n(21)),o=n(3),i=n(11),l=n(16),d=n(39),b=n(1),j=["children"];function p(e){var t=e.children,n=Object(d.a)(e,j),r=Object(i.c)().isAuthed,a=Object(o.h)().pathname;return Object(b.jsx)(o.b,Object(l.a)(Object(l.a)({},n),{},{children:r?t:Object(b.jsx)(o.a,{from:a,to:"/login"})}))}var f=n(6);function h(){var e=Object(r.useState)(),t=Object(f.a)(e,2),n=t[0],a=t[1],c=Object(i.c)().lid,s=Object(i.c)().ready;return Object(r.useEffect)((function(){s&&a(c)}),[s,c]),Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("h1",{children:"Main page"}),Object(b.jsx)("p",{children:n?n.voornaam:n})]})}var O=n(4),m=n(2),x=n.n(m),v=n(42);n(77);function g(){var e=Object(i.b)(),t=Object(o.g)(),n=Object(i.c)(),a=n.loading,c=n.error,s=n.isAuthed,u=Object(v.a)(),d=u.register,j=u.handleSubmit,p=u.formState.errors;Object(r.useEffect)((function(){s&&t.push("/")}));var f=Object(r.useCallback)(function(){var n=Object(O.a)(x.a.mark((function n(r){var a,c;return x.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=r.mail,c=r.wachtwoord,n.next=3,e({mail:a,wachtwoord:c});case 3:n.sent&&t.push("/");case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),[e,t]);return Object(b.jsx)("div",{className:"limit",children:Object(b.jsx)("div",{className:"conlogin",children:Object(b.jsxs)("div",{className:"wraplogin",children:[c?Object(b.jsx)("p",{className:"text-red-500 errorlogin",children:JSON.stringify(c)}):null,Object(b.jsxs)("form",{className:"loginform validate-form flex-sb flex-w",onSubmit:j(f),children:[Object(b.jsx)("span",{className:"loginformtitle",children:"Login"}),Object(b.jsxs)("div",{className:"wrapinput validate-input",children:[Object(b.jsx)("input",Object(l.a)({id:"mail",className:"input",type:"text",defaultValue:"","data-cy":"mail",placeholder:"mail"},d("mail",{required:"Dit is vereist"}))),Object(b.jsx)("span",{className:"focusinput"})]}),p.mail&&Object(b.jsx)("p",{children:p.mail.message}),Object(b.jsxs)("div",{className:"wrapinput validate-input",children:[Object(b.jsx)("input",Object(l.a)({id:"pw",className:"input",type:"password","data-cy":"wachtwoord",placeholder:"wachtwoord"},d("wachtwoord",{required:"Dit is vereist"}))),Object(b.jsx)("span",{className:"focusinput"})]}),p.wachtwoord&&Object(b.jsx)("p",{children:p.wachtwoord.message}),Object(b.jsxs)("div",{className:"conloginform",children:[Object(b.jsx)("button",{type:"submit",className:"loginbutton",disabled:a,"data-cy":"login",children:"Log in"}),console.log(a)]})]})]})})})}var w=function(){return Object(b.jsx)(i.a,{children:Object(b.jsx)(u.a,{children:Object(b.jsxs)(o.d,{children:[Object(b.jsx)(o.b,{exact:!0,path:"/login",children:Object(b.jsx)(g,{})}),Object(b.jsx)(o.b,{exact:!0,path:"/DendermondseBC-front",children:Object(b.jsx)(o.a,{to:"/"})}),Object(b.jsx)(p,{exact:!0,path:"/",children:Object(b.jsx)(h,{})})]})})})},k=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,79)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))};s.a.render(Object(b.jsx)(a.a.StrictMode,{children:Object(b.jsx)(w,{})}),document.getElementById("root")),k()}},[[78,1,2]]]);
//# sourceMappingURL=main.49a2bc4b.chunk.js.map