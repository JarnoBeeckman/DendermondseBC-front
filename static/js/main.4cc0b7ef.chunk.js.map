{"version":3,"sources":["context/AuthProvider.jsx","api/index.js","api/lid.js","components/PrivateRoute.jsx","pages/main.jsx","pages/login.jsx","App.js","reportWebVitals.js","index.js"],"names":["AuthContext","createContext","JWT_TOKEN_KEY","config","token_key","parseJWT","token","base64url","split","jsonPayLoad","Buffer","from","toString","JSON","parse","parseExp","exp","Number","isNaN","Date","useAuth","useContext","useSession","loading","error","lid","ready","hasRole","isAuthed","Boolean","useLogin","login","AuthProvider","children","useState","setReady","setLoading","setError","localStorage","getItem","setToken","setLid","setSession","useCallback","a","userId","expiry","stillValid","setItem","removeItem","api","LidApi","useEffect","mail","wachtwoord","user","console","register","data","logout","role","roles","include","value","useMemo","Provider","axios","axiosRoot","create","baseURL","url","setAuthToken","defaults","headers","post","voornaam","achternaam","adres","postcode","woonplaats","geslacht","geboortedatum","gsm","spelertype","getLidById","id","get","PrivateRoute","rest","pathname","useLocation","to","Main","elid","setElid","authLid","authReady","Login","history","useHistory","useForm","handleSubmit","errors","formState","push","handleLogin","className","stringify","onSubmit","type","defaultValue","placeholder","required","message","disabled","log","App","exact","path","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.4cc0b7ef.chunk.js","sourcesContent":["\nimport { createContext, useCallback, useContext, useMemo,useEffect,useState } from \"react\";\nimport * as api from \"../api\";\nimport * as LidApi from '../api/lid.js';\nimport config from '../config.json';\n\nconst AuthContext = createContext();\nconst JWT_TOKEN_KEY = config.token_key;\n\nfunction parseJWT(token) {\n    if (!token) return {};\n    const base64url = token.split('.')[1];\n    const payload = Buffer.from(base64url, 'base64');\n    const jsonPayLoad = payload.toString('ascii');\n    return JSON.parse(jsonPayLoad);\n}\nfunction parseExp(exp) {\n    if (!exp) return null;\n    if (typeof exp !== 'number') exp=Number(exp);\n    if (isNaN(exp)) return null;\n    return new Date(exp*1000);\n}\n\nconst useAuth = ()=> useContext(AuthContext);\n\nexport const useSession = ()=>{\n    const {loading,error,token,lid,ready, hasRole} = useAuth();\n    return {loading,error,token,lid,ready,isAuthed: Boolean(token), hasRole}\n}\n\nexport const useLogin = ()=>{\n    const {login} = useAuth();\n    return login;\n}\n\nexport const useLogout = ()=>{\n    const {logout} = useAuth();\n    return logout;\n}\nexport const useRegister = () =>{\n    const { register } = useAuth();\n    return register;\n}\nexport const AuthProvider = ({children})=>{\n    const [ready,setReady] = useState(false);\n    const [loading, setLoading] = useState(false);\n    const [error, setError] = useState('');\n    const [token,setToken] = useState(localStorage.getItem(JWT_TOKEN_KEY));\n    const [lid,setLid] = useState(null);\n\n    const setSession = useCallback(async (token,lid)=>{\n        const {exp,userId} = parseJWT(token);\n        const expiry = parseExp(exp);\n        const stillValid = expiry >= new Date();\n\n        if (stillValid) {\n            localStorage.setItem(JWT_TOKEN_KEY,token);\n        } else {\n            localStorage.removeItem(JWT_TOKEN_KEY);\n            token = null;\n            if (expiry) {\n                setError('Session expired, sign in again');\n            }\n        }\n        api.setAuthToken(token);\n        setReady(token && stillValid);\n        setToken(token);\n\n        if (!lid && stillValid) {\n            lid = await LidApi.getLidById(userId);\n        }\n        setLid(lid);\n    },[])\n\n    useEffect(()=>{\n       setSession(token);\n    },[token,setSession])\n\n    const login = useCallback(async({mail,wachtwoord})=>{\n        try {\n            setLoading(true)\n            setError('');\n            const {token,user} = await LidApi.login(mail,wachtwoord);\n            await setSession(token,user);\n            return true;\n        } catch(error) {\n            console.error(error)\n            setError('Login failed')\n            return false;\n        } finally {\n            setLoading(false);\n        }\n    },[setSession]);\n\n    const register = useCallback(async (data)=>{\n        try {\n            setLoading(true);\n            setError('');\n            const {token, lid} = await LidApi.register(data)\n            await setSession(token,lid);\n            return true;\n        } catch (error) {\n            setError(error);\n            return false;\n        } finally {\n            setLoading(false);\n        }\n    },[setSession])\n    const logout = useCallback(()=>{\n        setSession(null);\n        setLid(null);\n    },[setSession]);\n\n    const hasRole = useCallback((role)=>{\n        if (!lid) return false;\n        return lid.roles.include(lid)\n    },[lid])\n    \n    const value= useMemo(()=>({\n        loading,error,token,lid,login,logout,register,ready,hasRole\n    }),[loading,error,token,lid,login,logout,register,ready,hasRole]);\n\n    return (\n        <AuthContext.Provider value={value}>\n            {children}\n        </AuthContext.Provider>\n    );\n\n    \n}","import axiosRoot from \"axios\";\nimport config from \"../config.json\";\n\nexport const axios = axiosRoot.create({\n  baseURL: config.url,\n  /*headers: {\n    Authorization: `Bearer ${localStorage.getItem(config.token_key)}`,\n  },*/\n});\n\nexport const setAuthToken = (token) => {\n  if (token) {\n    axios.defaults.headers[\"Authorization\"] = `Bearer ${token}`;\n  } else {\n    delete axios.defaults.headers[\"Authorization\"];\n  }\n};\n","import {axios} from \".\";\n\n\nexport const login = async (mail,wachtwoord)=>{\n    const {data} = await axios.post(`account/login`,{\n        mail,wachtwoord\n    });\n    return data\n}\n\nexport const register = async (mail,wachtwoord,voornaam,achternaam,adres,postcode,woonplaats,geslacht,geboortedatum,gsm,spelertype)=>{\n  const {data} = await axios.post(`account`,{\n     mail,wachtwoord,voornaam,achternaam,adres,postcode,woonplaats,geslacht,geboortedatum,gsm,spelertype\n })\n return data\n}\n\nexport const getLidById = async (id)=>{\n    const {data} = await axios.get(`account/${id}`)\n    return data\n}","import { useLocation,Route,Redirect } from \"react-router-dom\";\nimport { useSession } from \"../context/AuthProvider\"\n\nexport default function PrivateRoute({children,...rest}) {\n    const {isAuthed} = useSession();\n    const {pathname} = useLocation();\n    return (\n        <Route {...rest}>\n            {\n                isAuthed ? (children) : (<Redirect from={pathname} to=\"/login\"/>)\n            }\n        </Route>\n    )\n}","import { useEffect, useState } from \"react\";\nimport { useSession } from \"../context/AuthProvider\"\n\nexport default function Main() {\n    const [elid, setElid] = useState();\n    const {lid: authLid} = useSession();\n    const {ready : authReady} = useSession();\n\n    useEffect(()=>{\n        if (authReady) {\n            setElid(authLid)\n        }\n    },[authReady,authLid])\n    return (<>\n    <h1>Main page</h1>\n    <p>{elid ? elid.voornaam : elid}</p>\n    </>)\n}","import { useCallback, useEffect } from \"react\";\nimport { useForm } from \"react-hook-form\"\nimport { useLogin, useSession } from \"../context/AuthProvider\";\nimport { useHistory } from \"react-router-dom\";\nimport './login.css'\n\n\nexport default function Login() {\n    const login = useLogin();\n    const history = useHistory();\n    const {loading,error,isAuthed} = useSession();\n    const { register, handleSubmit, formState: {errors} } = useForm();\n\n    useEffect(()=>{\n        if (isAuthed) {\n            history.push('/');\n        }\n    })\n\n    const handleLogin = useCallback(async({mail,wachtwoord})=>{\n        const e = await login({mail,wachtwoord});\n        if(e){\n            history.push('/');\n        }\n    },[login,history])\n\n    return (\n            <div className=\"limit\">\n                <div className=\"conlogin\">\n                    <div className=\"wraplogin\">\n                        {error ? (<p className=\"text-red-500 errorlogin\">{JSON.stringify(error)}</p>): null}\n                        <form className=\"loginform validate-form flex-sb flex-w\" onSubmit={handleSubmit(handleLogin)}>\n                            <span className=\"loginformtitle\">Login</span>\n                            <div className=\"wrapinput validate-input\">\n                                <input id=\"mail\" className=\"input\" type=\"text\" defaultValue=\"\" data-cy='mail' placeholder=\"mail\" {...register('mail',{required: 'Dit is vereist'})}/>\n                                <span className=\"focusinput\"></span>\n                            </div>\n                            {errors.mail && <p>{errors.mail.message}</p>}\n                            <div className=\"wrapinput validate-input\">\n                                <input id=\"pw\" className=\"input\" type=\"password\" data-cy='wachtwoord'placeholder=\"wachtwoord\" {...register('wachtwoord',{required: 'Dit is vereist'})}/>\n                                <span className=\"focusinput\"></span>\n                            </div>\n                            {errors.wachtwoord && <p>{errors.wachtwoord.message}</p>}\n                            <div className=\"conloginform\">\n                                <button type=\"submit\" className=\"loginbutton\" disabled={loading} data-cy='login' >Log in</button>\n                                {console.log(loading)}\n                            </div>\n                        </form>\n                    </div>\n                </div>\n            </div>\n    )\n\n}","import './App.css';\nimport { BrowserRouter, Route, Switch, Redirect } from \"react-router-dom\";\nimport { AuthProvider } from \"./context/AuthProvider\";\nimport PrivateRoute from \"./components/PrivateRoute\";\nimport Main from './pages/main';\nimport Login from './pages/login'\n\nfunction App() {\n  return (\n    <AuthProvider>\n      <BrowserRouter>\n      <Switch>\n        <Route exact path='/login'><Login /></Route>\n        <Route exact path='/DendermondseBC-front'><Redirect to='/' /></Route>\n        <PrivateRoute exact path='/'><Main /></PrivateRoute>\n      </Switch>\n      </BrowserRouter>\n    </AuthProvider>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}