(this.webpackJsonptoolbox=this.webpackJsonptoolbox||[]).push([[0],{11:function(e,t,r){"use strict";(function(e){r.d(t,"c",(function(){return O})),r.d(t,"b",(function(){return m})),r.d(t,"a",(function(){return x}));var n=r(4),a=r(6),c=r(2),u=r.n(c),o=r(0),i=r(15),s=r(23),l=r(22),d=r(1),b=Object(o.createContext)(),j=l.token_key;function f(t){if(!t)return{};var r=t.split(".")[1],n=e.from(r,"base64").toString("ascii");return JSON.parse(n)}function h(e){return e?("number"!==typeof e&&(e=Number(e)),isNaN(e)?null:new Date(1e3*e)):null}var p=function(){return Object(o.useContext)(b)},O=function(){var e=p(),t=e.loading,r=e.error,n=e.token,a=e.lid,c=e.ready,u=e.hasRole;return{loading:t,error:r,token:n,lid:a,ready:c,isAuthed:Boolean(n),hasRole:u}},m=function(){return p().login},x=function(e){var t=e.children,r=Object(o.useState)(!1),c=Object(a.a)(r,2),l=c[0],p=c[1],O=Object(o.useState)(!1),m=Object(a.a)(O,2),x=m[0],v=m[1],g=Object(o.useState)(""),w=Object(a.a)(g,2),k=w[0],y=w[1],S=Object(o.useState)(localStorage.getItem(j)),N=Object(a.a)(S,2),C=N[0],F=N[1],I=Object(o.useState)(null),L=Object(a.a)(I,2),A=L[0],B=L[1],J=Object(o.useCallback)(function(){var e=Object(n.a)(u.a.mark((function e(t,r){var n,a,c,o,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=f(t),a=n.exp,c=n.userId,o=h(a),(l=o>=new Date)?localStorage.setItem(j,t):(localStorage.removeItem(j),t=null,o&&y("Session expired, sign in again")),i.b(t),p(t&&l),F(t),r||!l){e.next=11;break}return e.next=10,s.a(c);case 10:r=e.sent;case 11:B(r);case 12:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),[]);Object(o.useEffect)((function(){J(C)}),[C,J]);var q=Object(o.useCallback)(function(){var e=Object(n.a)(u.a.mark((function e(t){var r,n,a,c,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.mail,n=t.wachtwoord,e.prev=1,v(!0),y(""),e.next=6,s.b(r,n);case 6:return a=e.sent,c=a.token,o=a.user,e.next=11,J(c,o);case 11:return e.abrupt("return",!0);case 14:return e.prev=14,e.t0=e.catch(1),console.error(e.t0),y("Login failed"),e.abrupt("return",!1);case 19:return e.prev=19,v(!1),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[1,14,19,22]])})));return function(t){return e.apply(this,arguments)}}(),[J]),E=Object(o.useCallback)(function(){var e=Object(n.a)(u.a.mark((function e(t){var r,n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,v(!0),y(""),e.next=5,s.c(t);case 5:return r=e.sent,n=r.token,a=r.lid,e.next=10,J(n,a);case 10:return e.abrupt("return",!0);case 13:return e.prev=13,e.t0=e.catch(0),y(e.t0),e.abrupt("return",!1);case 17:return e.prev=17,v(!1),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[0,13,17,20]])})));return function(t){return e.apply(this,arguments)}}(),[J]),R=Object(o.useCallback)((function(){J(null),B(null)}),[J]),T=Object(o.useCallback)((function(e){return!!A&&A.roles.include(A)}),[A]),D=Object(o.useMemo)((function(){return{loading:x,error:k,token:C,lid:A,login:q,logout:R,register:E,ready:l,hasRole:T}}),[x,k,C,A,q,R,E,l,T]);return Object(d.jsx)(b.Provider,{value:D,children:t})}}).call(this,r(49).Buffer)},15:function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return o}));var n=r(38),a=r.n(n),c=r(22),u=a.a.create({baseURL:c.url}),o=function(e){e?u.defaults.headers.Authorization="Bearer ".concat(e):delete u.defaults.headers.Authorization}},22:function(e){e.exports=JSON.parse('{"url":"https://dendermondse-bc.herokuapp.com/api/","token_key":"auth_token"}')},23:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return i})),r.d(t,"a",(function(){return s}));var n=r(4),a=r(2),c=r.n(a),u=r(15),o=function(){var e=Object(n.a)(c.a.mark((function e(t,r){var n,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.post("account/login",{mail:t,wachtwoord:r});case 2:return n=e.sent,a=n.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),i=function(){var e=Object(n.a)(c.a.mark((function e(t,r,n,a,o,i,s,l,d,b,j){var f,h;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.post("account",{mail:t,wachtwoord:r,voornaam:n,achternaam:a,adres:o,postcode:i,woonplaats:s,geslacht:l,geboortedatum:d,gsm:b,spelertype:j});case 2:return f=e.sent,h=f.data,e.abrupt("return",h);case 5:case"end":return e.stop()}}),e)})));return function(t,r,n,a,c,u,o,i,s,l,d){return e.apply(this,arguments)}}(),s=function(){var e=Object(n.a)(c.a.mark((function e(t){var r,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.get("account/".concat(t));case 2:return r=e.sent,n=r.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},47:function(e,t,r){},48:function(e,t,r){},77:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),c=r(37),u=r.n(c),o=(r(47),r(48),r(21)),i=r(3),s=r(11),l=r(16),d=r(39),b=r(1),j=["children"];function f(e){var t=e.children,r=Object(d.a)(e,j),n=Object(s.c)().isAuthed,a=Object(i.h)().pathname;return Object(b.jsx)(i.b,Object(l.a)(Object(l.a)({},r),{},{children:n?t:Object(b.jsx)(i.a,{from:a,to:"/login"})}))}var h=r(6);function p(){var e=Object(n.useState)(),t=Object(h.a)(e,2),r=t[0],a=t[1],c=Object(s.c)().lid,u=Object(s.c)().ready;return Object(n.useEffect)((function(){u&&a(c)}),[u,c]),Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("h1",{children:"Main page"}),Object(b.jsx)("p",{children:r?r.voornaam:r})]})}var O=r(4),m=r(2),x=r.n(m),v=r(42);function g(){var e=Object(s.b)(),t=Object(i.g)(),r=Object(s.c)(),a=r.loading,c=r.error,u=r.isAuthed,o=Object(v.a)(),d=o.register,j=o.handleSubmit,f=o.formState.errors;Object(n.useEffect)((function(){u&&t.push("/")}));var h=Object(n.useCallback)(function(){var r=Object(O.a)(x.a.mark((function r(n){var a,c;return x.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a=n.mail,c=n.wachtwoord,r.next=3,e({mail:a,wachtwoord:c});case 3:r.sent&&t.push("/");case 5:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),[e,t]);return Object(b.jsx)(b.Fragment,{children:Object(b.jsxs)("div",{className:"mx-auto",children:[Object(b.jsx)("h1",{className:"",children:"Log in"}),c?Object(b.jsx)("p",{className:"text-red-500 errorlogin",children:JSON.stringify(c)}):null,Object(b.jsxs)("form",{className:"grid grid-cols-1 login",onSubmit:j(h),children:[Object(b.jsx)("label",{htmlFor:"mail",children:"email:"}),Object(b.jsx)("input",Object(l.a)({id:"mail",type:"text",defaultValue:"","data-cy":"mail",placeholder:"your@mail.com"},d("mail",{required:"This is required"}))),f.mail&&Object(b.jsx)("p",{className:"text-red-500",children:f.mail.message}),Object(b.jsx)("label",{htmlFor:"wachtwoord",children:"wachtwoord:"}),Object(b.jsx)("input",Object(l.a)({id:"pw",type:"password","data-cy":"wachtwoord",placeholder:"wachtwoord"},d("wachtwoord",{required:"This is required"}))),f.wachtwoord&&Object(b.jsx)("p",{className:"text-red-500",children:f.wachtwoord.message}),Object(b.jsx)("div",{className:"loginbutton",children:Object(b.jsx)("button",{type:"submit",className:"disabled:opacity-50 lbut ",disabled:a,"data-cy":"login",children:"Log in"})})]})]})})}var w=function(){return Object(b.jsx)(s.a,{children:Object(b.jsx)(o.a,{children:Object(b.jsxs)(i.d,{children:[Object(b.jsx)(i.b,{exact:!0,path:"/login",children:Object(b.jsx)(g,{})}),Object(b.jsx)(f,{exact:!0,path:"/",children:Object(b.jsx)(p,{})})]})})})},k=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,78)).then((function(t){var r=t.getCLS,n=t.getFID,a=t.getFCP,c=t.getLCP,u=t.getTTFB;r(e),n(e),a(e),c(e),u(e)}))};u.a.render(Object(b.jsx)(a.a.StrictMode,{children:Object(b.jsx)(w,{})}),document.getElementById("root")),k()}},[[77,1,2]]]);
//# sourceMappingURL=main.627bcda7.chunk.js.map